# 运输层

**问题**
* 两个实体之间怎样才能在一种会丢失或损坏数据的媒介上可靠地通信
* 传输层的拥塞控制

运输层为运行在不同主机上的应用程序之间提供了逻辑通信功能。

## 多路复用与多路分解

将运输层报文段中的数据交付到正确的套接字的工作成为**多路分解**。
在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文段传输到网络层，这些工作成为**多路复用**。

**无连接的多路复用与分解**
当UDP报文段从网络到达时，主机通过报文中的目的端口号，将报文定向（分解）到响应的套接字。

**面向连接的多路复用与分解**
当一台主机作为服务器接受TCP连接时，根据连接的4元组创建标识一个新的套接字，当连接有TCP报文到达时，根据4元组信息，报文被定向到对应的套接字。

**套接字**是同一台主机内应用层与传输层之间的接口。由于该接口是建立网络应用程序的可编程接口，因此套接字也成为应用程序和网络之间的应用编程接口（Application Programming Interface，API）。

## 无连接传输：UDP

选择UDP的主要原因：
* 关于发送什么数据以及何时发送的应用层控制更加精细。
* 无需建立连接
* 无连接状态
* 分组首部开销小

 > UDP中缺乏拥塞控制会导致发送方和接收方之间的高丢包率，并挤垮TCP会话。

 ### UDP报文结构

| 16比特 | 16比特 |
| :-----:| :----: |
|源端口号|目的端口号|
|长度|校验和|
|应用数据（报文）|


**UDP**校验和差错检测的功能。

## 可靠数据传输原理

